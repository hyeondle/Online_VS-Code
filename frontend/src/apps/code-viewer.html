<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Viewer</title>
</head>
<body>
    <iframe id="codeViewerIframe" style="width: 100%; height: 100vh; border: none;"></iframe>

    <script>
        // URL에서 토큰 추출
        const urlParams = new URLSearchParams(window.location.search);
        const token = urlParams.get('token');

        if (!token) {
            alert('토큰이 없습니다. 다시 로그인 해주세요.');
        } else {
            // API를 호출하여 워크스페이스 URL을 가져와 iframe에 로드
            fetch('http://localhost:8000/api/account/workspace-url', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`,  // URL로 전달된 토큰 사용
                }
            })
            .then(response => response.text())
            .then(workspaceUrl => {
                // iframe에 워크스페이스 URL 로드
                document.getElementById('codeViewerIframe').src = workspaceUrl;
            })
            .catch(error => {
                console.error('워크스페이스 URL을 가져오는 데 실패했습니다:', error);
                alert('워크스페이스를 불러오는 데 실패했습니다.');
            });
        }
    </script>
</body>
</html>
